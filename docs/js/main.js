let options={signText:"",selectedPanel:{old:0,current:0},multilineText:!0,width:"",height:"",fontSize:"",verticalAlign:"center",horizontalAlign:"center",offsets:[0,0,0,0],fontBlur:"1",fontFamily:"",backgroundColor:null};const elements={textOnSignEl:document.getElementById("text-on-sign"),frogImageEl:document.getElementById("frogImage"),inputSignTextEl:document.getElementById("signText"),fontSizeInputEl:document.getElementById("fontSize"),offsetOptionsEls:document.getElementsByClassName("offsetOptions"),choosePanelEl:document.getElementsByClassName("options__btn--settings"),advFormEl:document.getElementsByClassName("advanced-options"),fontBlurEl:document.getElementById("fontBlur"),horizontalAlignEls:document.querySelectorAll("#horizontalAlign span"),verticalAlignEls:document.querySelectorAll("#verticalAlign span"),setToDefaultEl:document.getElementById("setToDefault"),resolutionWidthEl:document.getElementById("resolutionWidth"),resolutionHeightEl:document.getElementById("resolutionHeight")};function updateCategory(){elements.choosePanelEl[options.selectedPanel.old].classList.remove("options__btn--settings-active"),elements.choosePanelEl[options.selectedPanel.current].classList.add("options__btn--settings-active"),elements.advFormEl[options.selectedPanel.old].classList.add("display-none"),elements.advFormEl[options.selectedPanel.current].classList.remove("display-none")}function checkCategory(t){options.selectedPanel.old=options.selectedPanel.current,options.selectedPanel.current=t}for(let t=0;t<3;t++)elements.choosePanelEl[t].addEventListener("click",function(){checkCategory(t),updateCategory()});const apikey="AIzaSyDvwX-EQPmNL8RRY2yXxuMcRkPQ2iTqasw";let fonts=[],loadedFontlimits=50;function checkFontFamily(){options.fontFamily=document.getElementById("fontFamily").value}function updateFontFamily(){elements.textOnSignEl.style.fontFamily=options.fontFamily,document.getElementById("fontFamily").style.fontFamily=options.fontFamily}document.getElementById("fontFamily").addEventListener("change",()=>{checkFontFamily(),updateFontFamily()}),document.addEventListener("DOMContentLoaded",()=>{fetch("https://www.googleapis.com/webfonts/v1/webfonts?key=AIzaSyDvwX-EQPmNL8RRY2yXxuMcRkPQ2iTqasw&sort=popularity").then(t=>t.json()).then(n=>{for(let e=0;e<loadedFontlimits;e++)if(n.items[e].files.regular){fonts.push(new FontFace(n.items[e].family,`url(${n.items[e].files.regular})`));let t=document.createElement("option");t.style.fontFamily=n.items[e].family,t.innerText=n.items[e].family,document.getElementById("fontFamily").appendChild(t)}return fonts}).then(n=>{for(let e=0;e<n.length;e++)n[e].load().then(function(t){document.fonts.add(t),document.querySelectorAll("#fontFamily option")[e].style.fontFamily=n[e].family}).catch(()=>{console.log("couldnt load a font")})})});for(let t=0;t<=2;t++)elements.horizontalAlignEls[t].addEventListener("click",function(t){checkHorizontalAlign(t),updateHorizontalAlign()});function updateHorizontalAlign(){let e=null;for(let t=0;t<=2;t++)elements.horizontalAlignEls[t].classList.contains("options__select--active")&&elements.horizontalAlignEls[t].classList.remove("options__select--active"),elements.horizontalAlignEls[t].dataset.horizontalalign===options.horizontalAlign&&(e=t);elements.horizontalAlignEls[e].classList.add("options__select--active"),elements.textOnSignEl.style.textAlign=options.horizontalAlign}function checkHorizontalAlign(t){options.horizontalAlign=t.target.dataset.horizontalalign}function checkOffsets(t){options.offsets[t]=""===elements.offsetOptionsEls[t].value?"0":elements.offsetOptionsEls[t].value}function updateOffsets(){var t=`calc(7% + ${options.offsets[0]-options.offsets[1]}px`;elements.textOnSignEl.style.top=t;t=`calc(8% + ${options.offsets[2]-options.offsets[3]}px`;elements.textOnSignEl.style.left=t}function updateOffsetsInputs(){for(let t=0;t<elements.offsetOptionsEls.length;t++)elements.offsetOptionsEls[t].value=0===options.offsets[t]?"":options.offsets[t]}for(let t=0;t<=3;t++)elements.offsetOptionsEls[t].addEventListener("input",function(){checkOffsets(t),updateOffsets()});function setToDefaultOptions(){options.multilineText=!0,options.fontSize="",options.breakWords=!0,options.verticalAlign="center",options.horizontalAlign="center",options.offsets=[0,0,0,0],options.fontBlur="",options.fontBlur="",options.width="",options.height="",options.backgroundColor=null}elements.setToDefaultEl.addEventListener("click",function(){setToDefaultOptions(),adjustFontSizePeepo(),updateFontSize(),updateHorizontalAlign(),updateVerticalAlign(),updateOffsetsInputs(),updateOffsets(),defaultMultilineText(),checkMultilineText(),updateMultilineText(),handleEmptyAxis(),updateResolution()});let handleVerticalAlign=()=>{let n=document.querySelectorAll("#verticalAlign span"),o=1;for(let t=0,e=n.length;t<e;t++)n[t].addEventListener("click",function(){this.classList.contains("options__select--active")||(this.classList.add("options__select--active"),elements.textOnSignEl.style.alignItems=this.dataset.verticalalign,n[o].classList.remove("options__select--active"),o=t)})};handleVerticalAlign();for(let t=0;t<=2;t++)elements.verticalAlignEls[t].addEventListener("click",function(t){checkVerticalAlign(t),updateVerticalAlign()});function updateVerticalAlign(){let e=null;for(let t=0;t<=2;t++)elements.verticalAlignEls[t].classList.contains("options__select--active")&&elements.verticalAlignEls[t].classList.remove("options__select--active"),elements.verticalAlignEls[t].dataset.verticalalign===options.verticalAlign&&(e=t);elements.verticalAlignEls[e].classList.add("options__select--active"),elements.textOnSignEl.style.alignItems=options.verticalAlign}function checkVerticalAlign(t){options.verticalAlign=t.target.dataset.verticalalign}function capture(){var t=document.querySelector("#capture");html2canvas(t,{scrollY:-window.scrollY,backgroundColor:options.backgroundColor}).then(t=>(document.body.appendChild(t),t.style.display="none",t)).then(t=>{var e=t.toDataURL("image/png").replace("image/png","image/octet-stream");const n=document.createElement("a");n.setAttribute("download","peepoSign.png"),n.setAttribute("href",e),n.click(),t.remove()})}const btn=document.querySelector("#download");function addBrIfEmpty(t,e){""===e&&t.appendChild(document.createElement("br"))}btn.addEventListener("click",capture),elements.inputSignTextEl.addEventListener("input",function(t){options.signText=t.target.value,elements.textOnSignEl.textContent=options.signText,addBrIfEmpty(elements.textOnSignEl,elements.textOnSignEl.textContent)}),elements.textOnSignEl.addEventListener("input",function(){options.signText=elements.textOnSignEl.textContent,document.getElementById("signText").value=options.signText,addBrIfEmpty(elements.textOnSignEl,elements.textOnSignEl.textContent)});let shouldAdjustFontSize=!0;elements.fontSizeInputEl.addEventListener("input",function(){""===this.value?(adjustFontSizePeepo(),updateFontSize(),shouldAdjustFontSize=!0):(shouldAdjustFontSize=!1,options.fontSize=this.value+"px",updateFontSize())});const observeSignChanges=new MutationObserver(function(){elements.fontSizeInputEl.placeholder=Math.round(window.getComputedStyle(elements.textOnSignEl).fontSize.replace("px","")),shouldAdjustFontSize&&(adjustFontSizePeepo(),updateFontSize())});function adjustFontSizePeepo(){window.matchMedia("(min-width: 1024px)")?options.signText.length<=6?options.fontSize="7vw":options.signText.length<=19?options.fontSize="6vw":20<=options.signText.length&&(options.fontSize="3.5vw"):options.signText.length<=7?options.fontSize.fontSize="10vw":options.signText.length<=15?options.fontSize="6vw":16<=options.signText.length&&(options.fontSize="4vw")}function updateFontSize(){elements.textOnSignEl.style.fontSize=options.fontSize}function checkMultilineText(){document.getElementById("multiline").checked?options.multilineText="normal":options.multilineText="nowrap"}function updateMultilineText(){elements.textOnSignEl.style.whiteSpace=options.multilineText}function defaultMultilineText(){document.getElementById("multiline").checked=!0}observeSignChanges.observe(elements.textOnSignEl,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),adjustFontSizePeepo(),updateFontSize(),elements.frogImageEl.addEventListener("click",()=>{elements.textOnSignEl.focus()}),document.getElementById("multiline").addEventListener("input",function(){checkMultilineText(),updateMultilineText()});let proportion=508/469;function setMaxImageWidth(){options.width>document.getElementById("frogSection").offsetWidth&&(options.width=document.getElementById("frogSection").offsetWidth)}function setMaxImageHeight(){options.height>Math.round(proportion*+document.getElementById("frogSection").offsetWidth)&&(options.height=Math.round(proportion*+document.getElementById("frogSection").offsetWidth))}function removeMinusAxis(){options.width.toString().includes("-")&&(options.width=options.width.replace("-","")),options.height.toString().includes("-")&&(options.height=options.height.replace("-",""))}function handleEmptyAxis(){""===options.height&&(elements.frogImageEl.style.height="auto",elements.resolutionHeightEl.placeholder=""!==options.width?`${Math.round(options.width*proportion)}px`:"height"),""===options.width&&(elements.frogImageEl.style.width="auto",elements.resolutionWidthEl.placeholder=""!==options.height?`${Math.round(options.height/proportion)}px`:"width"),""===options.height&&""===options.width&&(elements.frogImageEl.style.height="",elements.frogImageEl.style.width="")}function checkWidth(){options.width=elements.resolutionWidthEl.value}function checkHeight(){options.height=elements.resolutionHeightEl.value}function updateResolution(){elements.frogImageEl.style.width=options.width+"px",elements.resolutionWidthEl.value=options.width,elements.frogImageEl.style.height=options.height+"px",elements.resolutionHeightEl.value=options.height}elements.resolutionHeightEl.addEventListener("input",function(){checkHeight(),removeMinusAxis(),setMaxImageHeight(),handleEmptyAxis(),updateResolution()}),elements.resolutionWidthEl.addEventListener("input",function(){checkWidth(),removeMinusAxis(),setMaxImageWidth(),handleEmptyAxis(),updateResolution()});